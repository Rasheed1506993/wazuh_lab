<svg viewBox="0 0 900 900" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-size="22" font-weight="bold" fill="#2C3E50">
    دليل ضبط الأداء والتحسين في Wazuh Indexer
  </text>
  
  <!-- Memory Management Section -->
  <rect x="50" y="70" width="800" height="180" fill="#3498DB" fill-opacity="0.1" stroke="#3498DB" stroke-width="3" rx="10"/>
  <text x="450" y="95" text-anchor="middle" font-size="18" font-weight="bold" fill="#2980B9">
    إدارة الذاكرة (Memory Management)
  </text>
  
  <!-- Memory Locking -->
  <rect x="80" y="115" width="370" height="120" fill="#2980B9" fill-opacity="0.2" stroke="#2980B9" stroke-width="2" rx="8"/>
  <text x="265" y="138" text-anchor="middle" font-size="14" font-weight="bold" fill="#1F618D">
    قفل الذاكرة (Memory Locking)
  </text>
  <text x="100" y="160" font-size="11" fill="#2C3E50">
    ملف التكوين: /etc/wazuh-indexer/opensearch.yml
  </text>
  <text x="100" y="178" font-size="11" fill="#2C3E50">
    الإعداد: bootstrap.memory_lock: true
  </text>
  <text x="100" y="196" font-size="11" fill="#2C3E50">
    systemd: LimitMEMLOCK=infinity
  </text>
  <text x="100" y="214" font-size="11" fill="#2C3E50">
    التحقق: curl ".../_nodes?filter_path=**.mlockall"
  </text>
  
  <!-- JVM Heap -->
  <rect x="470" y="115" width="360" height="120" fill="#2980B9" fill-opacity="0.2" stroke="#2980B9" stroke-width="2" rx="8"/>
  <text x="650" y="138" text-anchor="middle" font-size="14" font-weight="bold" fill="#1F618D">
    حجم ذاكرة JVM Heap
  </text>
  <text x="490" y="160" font-size="11" fill="#2C3E50">
    ملف التكوين: /etc/wazuh-indexer/jvm.options
  </text>
  <text x="490" y="178" font-size="11" fill="#2C3E50">
    القاعدة: 50% من ذاكرة النظام (بحد أقصى 32GB)
  </text>
  <text x="490" y="196" font-size="11" fill="#2C3E50">
    مثال لنظام 8GB: -Xms4g و -Xmx4g
  </text>
  <text x="490" y="214" font-size="11" fill="#2C3E50">
    مهم: Xms = Xmx لتجنب إعادة التخصيص
  </text>
  
  <!-- Shards and Replicas Section -->
  <rect x="50" y="280" width="800" height="220" fill="#9B59B6" fill-opacity="0.1" stroke="#9B59B6" stroke-width="3" rx="10"/>
  <text x="450" y="305" text-anchor="middle" font-size="18" font-weight="bold" fill="#8E44AD">
    الشاردز والنسخ المتماثلة (Shards & Replicas)
  </text>
  
  <!-- Shards Configuration -->
  <rect x="80" y="325" width="740" height="80" fill="#8E44AD" fill-opacity="0.15" stroke="#8E44AD" stroke-width="2" rx="8"/>
  <text x="450" y="348" text-anchor="middle" font-size="14" font-weight="bold" fill="#6C3483">
    تكوين الشاردز (Shards Configuration)
  </text>
  <text x="100" y="370" font-size="11" fill="#2C3E50">
    • القاعدة العامة: عدد الشاردز = عدد العقد في المجموعة
  </text>
  <text x="100" y="388" font-size="11" fill="#2C3E50">
    • لا يمكن تغيير العدد بعد الإنشاء دون إعادة فهرسة
  </text>
  
  <!-- Replicas Configuration -->
  <rect x="80" y="415" width="740" height="70" fill="#8E44AD" fill-opacity="0.15" stroke="#8E44AD" stroke-width="2" rx="8"/>
  <text x="450" y="438" text-anchor="middle" font-size="14" font-weight="bold" fill="#6C3483">
    تكوين النسخ المتماثلة (Replicas Configuration)
  </text>
  <text x="100" y="460" font-size="11" fill="#2C3E50">
    • مجموعة 3 عقد بدون نسخ: خطر فقدان البيانات    • مجموعة 3 عقد مع نسخة واحدة: توازن جيد (موصى به)
  </text>
  <text x="100" y="478" font-size="11" fill="#2C3E50">
    • مجموعة 3 عقد مع نسختين: توافرية عالية لكن تخزين 3x    • يمكن تغيير العدد في أي وقت
  </text>
  
  <!-- Re-indexing Section -->
  <rect x="50" y="530" width="800" height="180" fill="#E74C3C" fill-opacity="0.1" stroke="#E74C3C" stroke-width="3" rx="10"/>
  <text x="450" y="555" text-anchor="middle" font-size="18" font-weight="bold" fill="#C0392B">
    إعادة الفهرسة (Re-indexing)
  </text>
  
  <rect x="80" y="575" width="370" height="120" fill="#C0392B" fill-opacity="0.15" stroke="#C0392B" stroke-width="2" rx="8"/>
  <text x="265" y="598" text-anchor="middle" font-size="14" font-weight="bold" fill="#922B21">
    متى نحتاج لإعادة الفهرسة؟
  </text>
  <text x="100" y="620" font-size="11" fill="#2C3E50">
    • تغيير مخطط البيانات (Schema)
  </text>
  <text x="100" y="638" font-size="11" fill="#2C3E50">
    • تغيير عدد الشاردز
  </text>
  <text x="100" y="656" font-size="11" fill="#2C3E50">
    • تطبيق قوالب جديدة
  </text>
  <text x="100" y="674" font-size="11" fill="#2C3E50">
    • نسخ بيانات بين الفهارس
  </text>
  
  <rect x="470" y="575" width="360" height="120" fill="#C0392B" fill-opacity="0.15" stroke="#C0392B" stroke-width="2" rx="8"/>
  <text x="650" y="598" text-anchor="middle" font-size="14" font-weight="bold" fill="#922B21">
    طريقة إعادة الفهرسة
  </text>
  <text x="490" y="620" font-size="11" fill="#2C3E50">
    POST /_reindex
  </text>
  <text x="490" y="638" font-size="11" fill="#2C3E50">
    {"source": {"index": "old-index"},
  </text>
  <text x="490" y="656" font-size="11" fill="#2C3E50">
     "dest": {"index": "new-index"}}
  </text>
  <text x="490" y="674" font-size="11" fill="#2C3E50">
    النسخ يتم على دفعات لتقليل التأثير
  </text>
  
  <!-- Best Practices Section -->
  <rect x="50" y="740" width="800" height="140" fill="#16A085" fill-opacity="0.1" stroke="#16A085" stroke-width="3" rx="10"/>
  <text x="450" y="765" text-anchor="middle" font-size="18" font-weight="bold" fill="#138D75">
    أفضل الممارسات (Best Practices)
  </text>
  
  <text x="80" y="795" font-size="12" fill="#2C3E50">
    ١. راقب استخدام الذاكرة والقرص بشكل دوري من خلال /_nodes/stats
  </text>
  <text x="80" y="815" font-size="12" fill="#2C3E50">
    ٢. احتفظ بنسبة 15-20% من مساحة القرص فارغة لضمان الأداء الأمثل
  </text>
  <text x="80" y="835" font-size="12" fill="#2C3E50">
    ٣. نفذ استراتيجية لإدارة دورة حياة الفهارس (ILM) لحذف البيانات القديمة تلقائياً
  </text>
  <text x="80" y="855" font-size="12" fill="#2C3E50">
    ٤. اختبر إعدادات الأداء في بيئة تطوير قبل تطبيقها في بيئة الإنتاج
  </text>
</svg>