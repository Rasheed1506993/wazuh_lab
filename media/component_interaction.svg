<svg viewBox="0 0 950 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="475" y="35" text-anchor="middle" font-size="22" font-weight="bold" fill="#2C3E50">
    التفاعل التفصيلي بين مكونات منظومة Wazuh
  </text>
  
  <!-- Wazuh Agents Layer -->
  <rect x="50" y="70" width="850" height="90" fill="#E8F8F5" stroke="#16A085" stroke-width="2" rx="8"/>
  <text x="475" y="95" text-anchor="middle" font-size="16" font-weight="bold" fill="#16A085">
    وكلاء Wazuh (Agents)
  </text>
  
  <rect x="80" y="110" width="180" height="35" fill="#138D75" stroke="#0E6655" stroke-width="2" rx="5"/>
  <text x="170" y="132" text-anchor="middle" font-size="12" fill="white">
    Windows Agents
  </text>
  
  <rect x="280" y="110" width="180" height="35" fill="#138D75" stroke="#0E6655" stroke-width="2" rx="5"/>
  <text x="370" y="132" text-anchor="middle" font-size="12" fill="white">
    Linux Agents
  </text>
  
  <rect x="480" y="110" width="180" height="35" fill="#138D75" stroke="#0E6655" stroke-width="2" rx="5"/>
  <text x="570" y="132" text-anchor="middle" font-size="12" fill="white">
    macOS Agents
  </text>
  
  <rect x="680" y="110" width="180" height="35" fill="#138D75" stroke="#0E6655" stroke-width="2" rx="5"/>
  <text x="770" y="132" text-anchor="middle" font-size="12" fill="white">
    Cloud/Container Agents
  </text>
  
  <!-- Arrow from agents to manager -->
  <path d="M 475 160 L 475 200" stroke="#2C3E50" stroke-width="3" marker-end="url(#arrow)"/>
  <text x="500" y="185" font-size="11" fill="#2C3E50" font-weight="bold">
    Security Events
  </text>
  
  <!-- Wazuh Manager -->
  <rect x="250" y="200" width="450" height="140" fill="#EBF5FB" stroke="#3498DB" stroke-width="3" rx="10"/>
  <text x="475" y="230" text-anchor="middle" font-size="18" font-weight="bold" fill="#2980B9">
    Wazuh Manager (خادم التحليل)
  </text>
  
  <!-- Manager components -->
  <rect x="270" y="250" width="190" height="35" fill="#2980B9" stroke="#1F618D" stroke-width="2" rx="5"/>
  <text x="365" y="272" text-anchor="middle" font-size="11" fill="white">
    Analysis Engine (محرك التحليل)
  </text>
  
  <rect x="480" y="250" width="200" height="35" fill="#2980B9" stroke="#1F618D" stroke-width="2" rx="5"/>
  <text x="580" y="272" text-anchor="middle" font-size="11" fill="white">
    Rules Engine (محرك القواعد)
  </text>
  
  <rect x="270" y="295" width="190" height="35" fill="#2980B9" stroke="#1F618D" stroke-width="2" rx="5"/>
  <text x="365" y="317" text-anchor="middle" font-size="11" fill="white">
    alerts.json Output
  </text>
  
  <rect x="480" y="295" width="200" height="35" fill="#2980B9" stroke="#1F618D" stroke-width="2" rx="5"/>
  <text x="580" y="317" text-anchor="middle" font-size="11" fill="white">
    archives.json (اختياري)
  </text>
  
  <!-- Arrow from manager to filebeat -->
  <path d="M 475 340 L 475 380" stroke="#2C3E50" stroke-width="3" marker-end="url(#arrow)"/>
  <text x="510" y="365" font-size="11" fill="#2C3E50" font-weight="bold">
    File Reading
  </text>
  
  <!-- Filebeat -->
  <rect x="300" y="380" width="350" height="100" fill="#FEF5E7" stroke="#F39C12" stroke-width="3" rx="10"/>
  <text x="475" y="410" text-anchor="middle" font-size="18" font-weight="bold" fill="#D68910">
    Filebeat (ناقل البيانات)
  </text>
  
  <rect x="320" y="425" width="150" height="35" fill="#E67E22" stroke="#CA6F1E" stroke-width="2" rx="5"/>
  <text x="395" y="447" text-anchor="middle" font-size="11" fill="white">
    Log Monitoring
  </text>
  
  <rect x="485" y="425" width="150" height="35" fill="#E67E22" stroke="#CA6F1E" stroke-width="2" rx="5"/>
  <text x="560" y="447" text-anchor="middle" font-size="11" fill="white">
    Data Transformation
  </text>
  
  <!-- Arrow from filebeat to indexer -->
  <path d="M 475 480 L 475 520" stroke="#2C3E50" stroke-width="3" marker-end="url(#arrow)"/>
  <text x="385" y="505" font-size="11" fill="#2C3E50" font-weight="bold">
    HTTPS (Port 9200)
  </text>
  <text x="545" y="505" font-size="11" fill="#2C3E50" font-weight="bold">
    JSON/TLS
  </text>
  
  <!-- Wazuh Indexer -->
  <rect x="250" y="520" width="450" height="140" fill="#F4ECF7" stroke="#9B59B6" stroke-width="3" rx="10"/>
  <text x="475" y="550" text-anchor="middle" font-size="18" font-weight="bold" fill="#7D3C98">
    Wazuh Indexer (محرك الفهرسة)
  </text>
  
  <rect x="270" y="565" width="120" height="35" fill="#8E44AD" stroke="#6C3483" stroke-width="2" rx="5"/>
  <text x="330" y="587" text-anchor="middle" font-size="10" fill="white">
    API Endpoint
  </text>
  
  <rect x="405" y="565" width="130" height="35" fill="#8E44AD" stroke="#6C3483" stroke-width="2" rx="5"/>
  <text x="470" y="587" text-anchor="middle" font-size="10" fill="white">
    Ingest Pipeline
  </text>
  
  <rect x="550" y="565" width="120" height="35" fill="#8E44AD" stroke="#6C3483" stroke-width="2" rx="5"/>
  <text x="610" y="587" text-anchor="middle" font-size="10" fill="white">
    Indexing
  </text>
  
  <rect x="270" y="610" width="120" height="35" fill="#8E44AD" stroke="#6C3483" stroke-width="2" rx="5"/>
  <text x="330" y="632" text-anchor="middle" font-size="10" fill="white">
    Sharding
  </text>
  
  <rect x="405" y="610" width="130" height="35" fill="#8E44AD" stroke="#6C3483" stroke-width="2" rx="5"/>
  <text x="470" y="632" text-anchor="middle" font-size="10" fill="white">
    Storage
  </text>
  
  <rect x="550" y="610" width="120" height="35" fill="#8E44AD" stroke="#6C3483" stroke-width="2" rx="5"/>
  <text x="610" y="632" text-anchor="middle" font-size="10" fill="white">
    Query Engine
  </text>
  
  <!-- Arrow from indexer to dashboard -->
  <path d="M 700 590 L 760 590" stroke="#2C3E50" stroke-width="3" marker-end="url(#arrow)"/>
  <text x="730" y="610" font-size="11" fill="#2C3E50" font-weight="bold">
    REST API
  </text>
  
  <!-- Wazuh Dashboard -->
  <rect x="760" y="520" width="160" height="140" fill="#E8F6F3" stroke="#1ABC9C" stroke-width="3" rx="10"/>
  <text x="840" y="550" text-anchor="middle" font-size="16" font-weight="bold" fill="#16A085">
    Wazuh
  </text>
  <text x="840" y="570" text-anchor="middle" font-size="16" font-weight="bold" fill="#16A085">
    Dashboard
  </text>
  
  <rect x="780" y="585" width="120" height="30" fill="#16A085" stroke="#138D75" stroke-width="2" rx="5"/>
  <text x="840" y="605" text-anchor="middle" font-size="10" fill="white">
    Query Interface
  </text>
  
  <rect x="780" y="620" width="120" height="30" fill="#16A085" stroke="#138D75" stroke-width="2" rx="5"/>
  <text x="840" y="640" text-anchor="middle" font-size="10" fill="white">
    Visualizations
  </text>
  
  <!-- Information Box -->
  <rect x="50" y="690" width="850" height="90" fill="#F8F9F9" stroke="#34495E" stroke-width="2" rx="8"/>
  <text x="475" y="715" text-anchor="middle" font-size="15" font-weight="bold" fill="#2C3E50">
    معلومات التدفق الرئيسية
  </text>
  
  <text x="70" y="740" font-size="12" fill="#2C3E50">
    ١. الوكلاء يرسلون الأحداث إلى خادم Wazuh عبر بروتوكول TCP مشفر
  </text>
  <text x="70" y="758" font-size="12" fill="#2C3E50">
    ٢. خادم Wazuh يحلل ويُنشئ التنبيهات ويخزنها في ملفات JSON محلية
  </text>
  <text x="70" y="776" font-size="12" fill="#2C3E50">
    ٣. Filebeat يقرأ الملفات ويرسلها عبر HTTPS إلى Wazuh Indexer للفهرسة والتخزين
  </text>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrow" markerWidth="12" markerHeight="12" refX="11" refY="3" orient="auto">
      <polygon points="0 0, 12 3, 0 6" fill="#2C3E50"/>
    </marker>
  </defs>
</svg>